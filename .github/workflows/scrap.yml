name: Scrap showtimes

on:
  workflow_dispatch:
    inputs:
      days:
        default: 90
        type: number
        description: Days
        required: true
  schedule:
    - cron:  '0 2 * * *'

jobs:
  scrap:
    name: Scrap showtimes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: superfly/flyctl-actions/setup-flyctl@master
      - run: flyctl ssh console -a cinecal -C "node ./build/cli ${{ inputs.days }}"
        env:
          FLY_API_TOKEN: ${{ secrets.FLY_API_TOKEN }}